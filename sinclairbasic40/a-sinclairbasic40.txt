TABLE ORG 60000 LD HL,TTTTT LD (23728),HL LD A,64 LD (23608),A LD A,40 LD (23609),A JP STARTMCODE LD A,(5C3AH) CP 255 JP NZ,KEYBRBREND LD A,(5C3AH) CP 11 JR Z,JUMPERROR BIT 7,(IY+1) JR NZ,JUMP2 EXX  PUSH HL LD D,0 LD E,(IY+254) LD HL,0890H CALL 03B5H POP HL EXX  LD (IY+0),11 LD HL,(5C5DH) LD (5C5FH),HL LD HL,MCODE PUSH HL CALL 16C5H JP 12B7HJUMP2 CALL 1303H LD (IY+0),255 LD HL,(5C59H) CALL 11A7H LD HL,MCODE PUSH HL CALL 16C5H JP 12B4HJUMP LD HL,(5C5DH) DEC HL LD A,(HL) CP "*" JR NZ,ERROR RST 18H CP "L" JR Z,LOAD CP "S" JR Z,SAVE CP "C" JP Z,COPY CP "R" JP Z,NEW CP "B" JP Z,BOX CP "W" JP Z,WAITK CP "N" JP Z,NUMBE CP "D" JP Z,ADRAW CP "P" JP Z,DPOKE CP "T" JP Z,TRANS CP "M" JP Z,SMOVE CP "X" JP Z,JCLS CP "Z" JP Z,ZERRU CP "U" JP Z,USERG CP "A" JP Z,CIRCL CP "K" JP Z,KOPIE CP "V" JP Z,FARBE CP "F" JP Z,FILL CP "E" JP Z,ELIPS CP "G" JP Z,BBREA JP ERRORSAVE LD (LAB3),A JR NEXTLOAD LD (LAB3),ANEXT RST 20H CP 32 JR Z,NEXT CALL NOERR CALL 1C7AH BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,NEXT2 CP 58 JP NZ,ERRORNEXT2 CALL NOERR BIT 7,(IY+1) JR NZ,NEXT3NOPRG LD HL,MCODE PUSH HL LD HL,12B7H PUSH HL JP 1B76HNEXT3 CALL 2DA2H LD D,B LD E,C PUSH DE CALL 2DA2H PUSH BC POP IX POP DE LD A,(LAB3) CP "S" JR Z,SAVEC LD A,255 SCF  CALL 0556HENDE CALL 16C5H LD HL,MCODE PUSH HL JP 1B76HSAVEC LD A,255 SCF  CALL 04C2H JR ENDECOPY RST 20H CP 13 JR Z,NEXTT CP 58 JR Z,NEXTT JP ERRORNEXTT CALL NOERR BIT 7,(IY+1) JR Z,NOPRG DI  LD B,192 CALL 0EAFH EI  JR ENDENEW RST 20H CP 13 JR Z,NEWN CP 58 JR Z,NEWN JP ERRORNEWN CALL NOERR BIT 7,(IY+1) JR Z,NOPRG LD HL,RESET LD (HL),0 INC HL LD (HL),0 LD HL,RESET LD DE,RESET INC DE LD BC,5000 LDIR  LD DE,3EAFH LD HL,65535 LD BC,0A8H EX DE,HL LDDR  INC HL LD (5C7BH),HL LD BC,40H LD (5C38H),BC LD A,255 JP 11B7HBOX RST 20H CP 32 JR Z,BOX CALL NOERR CALL 1C7AH BIT 7,(IY+0) JP Z,ERROR RST 18H CP ";" JP NZ,ERROR RST 20H CALL 1C7AH BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,BOX2 CP 58 JR Z,BOX2 JP ERRORBOX2 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL MASK CALL 2DD5H LD B,0 LD C,A LD (LAB2),BC CALL 2DD5H LD BC,(LAB2) LD B,A LD (LAB2),BC CALL 2DD5H LD D,A LD (LAB),DE CALL 2DD5H LD DE,(LAB) LD E,A LD A,D LD (LAB),DE LD BC,(LAB) LD DE,(LAB2) LD A,B CP 176 JP NC,ENDE LD A,DJU1 PUSH BC PUSH AF CALL 22E5H POP AF POP BC INC C DEC A CP 0 JR NZ,JU1 LD DE,(LAB2) LD A,EJU2 PUSH BC PUSH AF LD A,B CP 176 CALL C,22E5H POP AF POP BC INC B DEC A CP 0 JR NZ,JU2 LD DE,(LAB2) LD A,DJU3 PUSH BC PUSH AF LD A,B CP 176 CALL C,22E5H POP AF POP BC DEC C DEC A CP 0 JR NZ,JU3 LD DE,(LAB2) LD A,EJU4 PUSH BC PUSH AF LD A,B CP 176 CALL C,22E5H POP AF POP BC DEC B DEC A CP 0 JR NZ,JU4 JP ENDELAB DEFW 0LAB2 DEFW 0LAB3 DEFB 0LAB4 DEFB 0TAB DEFB 128 DEFM "      Sinclair-Basic V4.0       " DEFB 127 DEFM " by S.Slabihoud SOFTWARE *1986" DEFB 170START LD HL,(23621) INC HL INC HL LD A,H OR L LD (LAB4),A LD DE,MCODE LD HL,(5C3DH) LD (HL),E INC HL LD (HL),D LD A,(LAB4) CP 0 RET NZ LD A,0 LD (23560),A LD (IY+0C6H),255 LD (IY+0CAH),255 LD (IY+31H),2 CALL 0D6BH XOR A LD DE,TAB CALL 0C0AH SET 5,(IY+2) RES 3,(IY+1) JP 12A9HWAITK RST 20H CP 32 JR Z,WAITK CALL NOERR CALL 24FBH BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,WWN CP 58 JP NZ,ERRORWWN CALL NOERR BIT 7,(IY+1) JP Z,NOPRG BIT 6,(IY+1) CALL Z,2BF1H JR NZ,NUMX LD A,(DE) JR NUMYNUMX CALL 2DD5HNUMY PUSH AF LD A,0 LD (23560),A POP AF LD B,A XOR A LD A,0NUMZ LD A,(23560) CP B JR NZ,NUMZ LD A,0 LD (23560),A JP ENDENUMBE RST 20H CP 13 JR Z,NEXNU CP 58 JP NZ,ERRORNEXNU CALL NOERR BIT 7,(IY+1) JP Z,NOPRG LD HL,(5C53H) LD BC,(5C4BH) INC HL INC HL INC HL INC HLJIMM LD A,(HL) CP 14 JR Z,ZAHLN CP 13 JR Z,NEWLI INC HL PUSH HL SBC HL,BC POP HL JP NC,ENDE JR JIMMZAHLN PUSH HL DEC HLOK LD (HL),"." DEC HL LD A,(HL) CP "0" JR Z,OK JR C,NICTT CP "9" JR Z,OK JR C,OKNICTT POP HL INC HLNEWLI INC HL INC HL INC HL INC HL INC HL JR JIMM DRAW RST 20H CP 32 JR Z,ADRAW CALL NOERR CALL 1C7AH BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,ADRNE CP 58 JP NZ,ERRORADRNE CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL MASK LD BC,0 CALL 2DD5H LD B,A CP 176 JR C,ADNZG LD B,175ADNZG LD (LAB2),BC CALL 2DD5H LD BC,(LAB2) LD C,A LD (LAB2),BC LD DE,0101H LD HL,0000H LD H,B LD A,(23678) CP H JR NC,NEG1 LD H,A LD A,B SUB H LD B,ARET1 LD (LAB2),BC LD H,C LD A,(23677) CP H JR NC,NEG2 LD H,A LD A,C SUB H LD C,A RET2 LD (LAB2),BC LD (LAB),DE EXX  PUSH HL LD BC,(LAB2) LD DE,(LAB) CALL 24BAH POP HL EXX  JP ENDENEG1 LD A,(23678) SUB B LD B,A LD D,255 JR RET1NEG2 LD A,(23677) SUB C LD C,A LD E,255 JR RET2DPOKE RST 20H CP 32 JR Z,DPOKE CALL NOERR CALL 1C7AH BIT 7,(IY+0) JP Z,ERROR CP 13 JR Z,DPONE CP 58 JP NZ,ERRORDPONE CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DA2H LD (LAB),BC CALL 2DA2H LD (POLAB),BC LD BC,(LAB) DEFB 237 DEFB 67POLAB DEFW 0 JP ENDETRANS RST 20H CP "D" JR Z,LDR CP "U" JR Z,LDR JP ERRORLDR LD (LAB4),ALDJUM RST 20H CP 32 JR Z,LDJUM CALL NOERR CALL 1C7AH RST 18H CP "," JP NZ,ERROR RST 20H CALL 1C82H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,TRAN2 CP 58 JP NZ,ERRORTRAN2 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DA2H LD (LAB),BC CALL 2DA2H LD (LAB2),BC CALL 2DA2H LD H,B LD L,C LD DE,(LAB2) LD BC,(LAB) LD A,(LAB4) CP "D" JR Z,LDDR LDIR  JP ENDE LDDR LDDR  JP ENDESMOVE RST 20H CP "L" JR Z,MOOK CP "R" JR Z,MOOK CP "U" JR Z,MOOK CP "D" JP NZ,ERRORMOOK LD (LAB3),AMOJUM RST 20H CP 32 JR Z,MOJUM CALL NOERR CALL 1C82H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,MOJ1 CP 58 JR NZ,MOJ1MOJ1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DD5H LD (LAB4),A LD A,(LAB3) CP "L" JP Z,LSCRO CP "R" JR Z,RSCRO CP "U" JR Z,USCRODSCRO LD A,(LAB4) LD B,AK5 PUSH BC LD A,7 LD B,17H LD C,0K4 DI  CALL K1 EX DE,HL DEC A  CP 255 JR NZ,K2 DEC B LD A,B CP 255 JR Z,K3 LD A,7K2 DI  CALL K1 EX DE,HL PUSH BC LD BC,20H LDIR  POP BC JR K4K3 POP BC DJNZ K5 JP ENDEUSCRO LD A,(LAB4) LD B,AK9 PUSH BC XOR A LD B,A LD C,AK8 DI  CALL K1 INC A CP 8H JR C,K6 INC B LD A,B CP 18H JR NC,K7 XOR AK6 EX DE,HL DI  CALL K1 EX DE,HL PUSH BC LD BC,20H LDIR  POP BC JR K8K7 POP BC DJNZ K9 JP ENDERSCRO LD A,(LAB4) LD C,AK12 LD HL,4000H LD B,0C0HK11 LD E,20H XOR AK10 LD A,(HL) RRA  LD (HL),A INC HL DEC E JR NZ,K10 DJNZ K11 DEC C JR NZ,K12 JP ENDEK1 EI  PUSH AF PUSH AF LD A,B AND 18H OR 40H LD D,A POP AF ADD D LD D,A LD A,B AND 7H RRCA  RRCA  RRCA  ADD C LD E,A POP AF RET LSCRO LD A,(LAB4) LD C,AK15 LD HL,3FFFH LD B,0C0H K14 LD DE,20H ADD HL,DE PUSH HL XOR AK13 LD A,(HL) RLA  LD (HL),A DEC HL DEC E JR NZ,K13 POP HL DJNZ K14 DEC C JR NZ,K15 JP ENDE JCLS CALL NOERR RST 20H CP 13 JR Z,CLSOK CP 58 JP NZ,ERRORCLSOK CALL NOERR BIT 7,(IY+1) JP Z,NOPRG LD B,8CLSNN LD HL,4000H LD DE,1800HCLSNE SRL (HL) INC HL DEC DE LD A,D OR E JR NZ,CLSNE DJNZ CLSNN CALL 0D6BH JP ENDEZERRU CALL NOERR RST 20H CP 13 JR Z,ZERNE CP 58 JP NZ,ERRORZERNE CALL NOERR BIT 7,(IY+1) JP Z,NOPRG LD B,0 LD C,0ZERNN PUSH BC CALL 22AAH LD B,A INC B LD A,(HL)ZERJU RLCA  DJNZ ZERJU AND 1 POP BC CP 1 CALL Z,UPPRG PUSH BC CALL 22E5H POP BC PUSH BC SET 0,(IY+87) CALL 22E5H RES 0,(IY+87) POP BC DI  CALL 1F54H EI  JP NC,ENDE INC C LD A,C CP 0 JR NZ,ZERNN LD C,0 INC B LD A,B CP 176 JR NZ,ZERNN JP ENDEUPPRG PUSH BC SET 0,(IY+87) CALL 22E5H RES 0,(IY+87) POP BC LD (LAB),BC LD A,B CALL 2D28H LD DE,(5C65H) LD HL,FPZ1 LD BC,5 LDIR  LD (5C65H),DE RST 28H DEFB 4 DEFB 38H CALL 2DD5H LD BC,(LAB) LD B,A CALL 22E5H LD BC,(LAB) RET FPZ1 DEFB 128 DEFB 89 DEFB 153 DEFB 153 DEFB 153USERG RST 20H CP 32 JR Z,USERG CALL NOERR CALL 1C82H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,USENE CP 58 JP NZ,ERRORUSENE CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DD5H LD HL,65368 CP 5 JR NC,USEND CP 0 JR Z,USE0 CP 1 JR Z,USE1 CP 2 JR Z,USE2 CP 3 JR Z,USE3 CP 4 JP NZ,ERRORUSE4 LD HL,USER4 JR USENDUSE3 LD HL,USER3 JR USEND USE2 LD HL,USER2 JR USENDUSE1 LD HL,USER1 JR USENDUSE0 LD HL,65368USEND LD (23675),HL JP ENDECIRCL RST 20H CP 32 JR Z,CIRCL CALL NOERR CALL 1C7AH RST 18H CP "," JP NZ,ERROR CALL 1C81H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,CIRC1 CP 58 JP NZ,ERRORCIRC1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL MASK LD HL,23698 LD (23656),HL RST 28H DEFB 31H DEFB 04H DEFB 0C1H DEFB 02H DEFB 0A0H DEFB 0C2H DEFB 02H DEFB 38H CALL USTHL LD (YMPOS),HL CALL USTHL LD (XMPOS),HLNEXTX RST 28H DEFB 0E1H DEFB 0E2H DEFB 31H DEFB 04H DEFB 03H DEFB 38H CALL 2DA2H LD H,B LD L,C LD BC,00FFH LD DE,0FFFEHSQRLP INC C INC DE INC DE SCF  SBC HL,DE INC HL JR NC,SQRLP CALL 2D2BH RST 28H DEFB 0E2H DEFB 38H CALL USTHL LD (XOFF),HL CALL USTHL LD (YOFF),HL LD BC,804HPLOOP PUSH BC LD HL,(XMPOS) LD BC,(XOFF) ADD HL,BC LD A,H AND A JR NZ,NPLOT EX DE,HL LD HL,(YMPOS) LD BC,(YOFF) ADD HL,BC LD A,H AND A JR NZ,NPLOT LD A,L CP 176 LD B,L LD C,E CALL C,22E5HNPLOT LD HL,(YOFF) CALL NEGAT LD (YOFF),HL POP BC BIT 0,B JR Z,NXNEG LD HL,(XOFF) CALL NEGAT LD (XOFF),HLNXNEG DEC C JR NZ,NOEXG LD HL,(XOFF) LD DE,(YOFF) LD (YOFF),HL LD (XOFF),DENOEXG DJNZ PLOOP RST 28H DEFB 0E2H DEFB 0A1H DEFB 0FH DEFB 0C2H DEFB 02H DEFB 38H LD DE,(XOFF) LD HL,(YOFF) AND A SBC HL,DE JP C,NEXTX JP ENDEUSTHL CALL 2DA2H LD H,B LD L,C CALL C,ERRB RET ZNEGAT LD A,L CPL  LD L,A LD A,H CPL  LD H,A INC HL RET ERRB CCF  RET  XMPOS DEFW 0 YMPOS DEFW 0 XOFF DEFW 0YOFF DEFW 0KOPIE RST 20H CP 13 JR Z,KOPI1 CP 58 JP NZ,ERRORKOPI1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 0D6BH LD HL,22528 LD B,0KOOP1 LD (HL),0 INC HL DJNZ KOOP1 LD A,2 CALL 1601H LD DE,KOTAB LD BC,88 CALL 203CH LD A,1 CALL 1601H LD DE,TAPEC LD BC,35 CALL 203CH JR KOOP2TAPEC DEFB 22 DEFB 1 DEFB 0 DEFB 32 DEFB 127 DEFM " by S.Slabihoud SOFTWARE 1986 "KOTAB DEFB 22 DEFB 10 DEFB 6 DEFM "           Load...1" DEFB 22 DEFB 12 DEFB 6 DEFM "Headerless-Load...2" DEFB 22 DEFB 14 DEFB 6 DEFM "           Save...3" DEFB 22 DEFB 17 DEFB 6 DEFM "         Return...5"KOOP2 LD HL,KOPST LD DE,16384 LD BC,210 LDIR  LD SP,65535 JP 16384KOPST LD SP,65535 LD BC,63486 IN A,(C) PUSH AF AND 1 JR Z,LHEAD POP AF PUSH AF AND 2 JR Z,LPROG POP AF PUSH AF AND 4 JR Z,SPROG POP AF PUSH AF AND 16 JR Z,KOEND POP AF JR KOPSTKOEND RST 0HLHEAD POP AFLOADE LD IX,23600 LD DE,17 LD A,0 SCF  CALL 0556H JR NC,LOADE LD A,1 LD (23620),A JR KOJU1LPROG LD A,0 LD (23620),A POP AFKOJU1 LD IX,23640 LD DE,41895 LD A,255 SCF  CALL 0556H PUSH IX POP HL LD DE,23640 AND A SBC HL,DE INC HL LD (23621),HLZSTAR JR KOPSTSPROG POP AF LD A,(23620) CP 0 JR Z,KOJU2 LD IX,23600 LD DE,17 LD A,0 SCF  CALL 04C2H LD HL,0415HKOWAR DJNZ KOWAR DEC HL LD A,H OR L JR NZ,KOWARKOJU2 LD IX,23640 LD DE,(23621) LD A,255 SCF  CALL 04C2H JR ZSTARFARBE RST 20H LD (LAB4),A CP "I" JR Z,FAROK CP "C" JR Z,FAOK1 CP "D" JP Z,FVDU CP "P" JP NZ,ERRORFAROK CALL NOERR CALL 1C79H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,FARB1 CP 58 JP NZ,ERRORFARB1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG LD A,(LAB4) CP "I" JR Z,FAINK CALL 2DD5H RLCA  RLCA  RLCA  LD C,A PUSH BC CALL 2DD5H RLCA  RLCA  RLCA  POP BC LD B,A LD D,38H LD E,0C7HTOGGL LD HL,5800HTOLOO LD A,(HL) PUSH AF AND D CP B JR Z,TOLOK POP AF JR TOLNETOLOK POP AF AND E OR C LD (HL),ATOLNE INC HL LD A,H CP 5BH JR NZ,TOLOO JP ENDEFAINK CALL 2DD5H LD C,A PUSH BC CALL 2DD5H POP BC LD B,A LD D,07H LD E,0F8H JR TOGGLFAOK1 RST 20H LD (LAB4),A CP "I" JR Z,FAJU1 CP "P" JP NZ,ERRORFAJU1 CALL NOERR CALL 1C81H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,FAJU2 CP 58 JP NZ,ERRORFAJU2 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG LD A,(LAB4) CP "I" JR Z,FAJU3 CALL 2DD5H RLCA  RLCA  RLCA  LD C,A LD E,0C7HT1GGL LD HL,5800HT1LOO LD A,(HL) AND E OR C LD (HL),A INC HL LD A,H CP 5BH JR NZ,T1LOO JP ENDE FAJU3 CALL 2DD5H LD C,A LD E,0F8H JR T1GGLFVDU RST 20H CP "U" JP NZ,ERROR CALL NOERR CALL 1C79H RST 18H CP "," JP NZ,ERROR CALL 1C79H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,FVDU1 CP 58 JP NZ,ERROR FVDU1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DD5H RLCA  RLCA  RLCA  RLCA  RLCA  RLCA  LD C,A PUSH BC CALL 2DD5H RLCA  RLCA  RLCA  RLCA  RLCA  RLCA  RLCA  POP BC OR C LD C,A PUSH BC CALL 2DD5H RLCA  RLCA  RLCA  POP BC OR C LD C,A PUSH BC CALL 2DD5H POP BC OR C LD C,A LD HL,5800HT2LOO LD (HL),C INC HL LD A,H CP 5BH JR NZ,T2LOO JP ENDENOERR LD (IY+0),255 LD (IY+38),0 RET FILL CALL NOERR CALL 1C79H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,FILL1 CP 58 JP NZ,ERRORFILL1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL MASK CALL UN2ST LD (5C7DH),BC LD HL,ENDE PUSH HL LD D,B LD E,CFILJ2 CALL FILJ1 JR C,FILJ3 INC B LD A,B CP 0B0H JR C,FILJ2FILJ3 LD B,D LD A,B DEC B AND A RET ZFILJ4 CALL FILJ1 RET C LD A,B DEC B AND A JR NZ,FILJ4 RET FILJ1 LD C,EFILJ5 CALL FILJ7 JR NC,FILJ6 LD A,C CP E SCF  RET Z JR FILJ8FILJ6 INC C JR NZ,FILJ5FILJ8 LD C,E LD A,C DEC C AND A SCF  CCF  RET Z FILJA CALL FILJ7 JR NC,FILJ9 LD A,E DEC A CP C SCF  RET Z OR A RET FILJ9 LD A,C DEC C AND A JR NZ,FILJA OR A RET FILJ7 PUSH BC PUSH DE CALL 22AAH LD B,A INC B LD A,(HL)FILJB RLCA  DJNZ FILJB JR C,FILJC LD A,C AND 07H CALL 22ECH OR AFILJC POP DE POP BC RET UN2ST CALL 2DD5H LD B,A PUSH BC CALL 2DD5H POP BC LD C,A RET ELIPS CALL NOERR CALL 1C79H RST 18H CP ";" JP NZ,ERROR CALL 1C79H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,ELIP1 CP 58 JP NZ,ERRORELIP1 CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL MASK LD HL,MCODE PUSH HL CALL UN2ST LD (5C7DH),BC CALL 2DD5H LD (LAB2),A CALL 2DD5H LD (LAB3),A CALL 16C5H LD A,(IY+67) CALL 2D28H LD A,(IY+68) CALL 2D28H LD A,(LAB3) CALL 2D28H LD A,(LAB2) CALL 2D28H RST 28H DEFB 0A4H DEFB 05H DEFB 0C3H DEFB 02H DEFB 0C2H DEFB 02H DEFB 0C1H DEFB 02H DEFB 0C0H DEFB 02H DEFB 0A0H DEFB 0E2H DEFB 0E3H DEFB 04H DEFB 38H CALL 2DD5H LD C,A LD A,(5C7DH) ADD C LD (5C7DH),AELJU1 RST 28H DEFB 31H DEFB 34H DEFB 40H DEFB 0B0H DEFB 00H DEFB 5AH DEFB 05H DEFB 0A3H DEFB 04H DEFB 31H DEFB 38H LD HL,BUFF2 LD (5C68H),HL RST 28H DEFB 20H DEFB 38H LD HL,5C92H LD (5C68H),HL RST 28H DEFB 0E2H DEFB 04H DEFB 0E3H DEFB 04H DEFB 0E0H DEFB 0FH DEFB 01H DEFB 38H LD HL,BUFF2 LD (5C68H),HL RST 28H DEFB 1FH DEFB 38H LD HL,5C92H LD (5C68H),HL RST 28H DEFB 0E2H DEFB 04H DEFB 0E1H DEFB 0FH DEFB 38H LD HL,BUFF2 LD (5C68H),HL CALL ELIP2 LD HL,5C92H LD (5C68H),HL RST 28H DEFB 0A4H DEFB 0A2H DEFB 04H DEFB 0FH DEFB 31H DEFB 38H CALL 2DA2H LD HL,0168H OR A SBC HL,BC JR NC,ELJU1 RST 28H DEFB 02H DEFB 0E0H DEFB 0E1H DEFB 38H CALL 2307H LD (5C7DH),BC CALL 16C5H JP 1B76H ELIP2 LD A,(IY+68) CALL 2D28H LD A,(IY+67) CALL 2D28H RST 28H DEFB 0C0H DEFB 02H DEFB 03H DEFB 01H DEFB 0E0H DEFB 03H DEFB 01H DEFB 38H JP 24B7H MASK RES 0,(IY+2) CALL 0D4DH CALL 1CADH RET  DEFM "**** written by s.slabihoud ****" BBREA CALL NOERR CALL 1C81H BIT 7,(IY+0) JP Z,ERROR RST 18H CP 13 JR Z,BREOK CP 58 JP NZ,ERRORBREOK CALL NOERR BIT 7,(IY+1) JP Z,NOPRG CALL 2DD5H CP 0 JR Z,BRAUS CP 1 JP NZ,ERRORBREIN LD A,0 LD (BRLAB),A JP ENDEBRAUS LD A,1 LD (BRLAB),A JP ENDEBRLAB DEFB 0KEYBR LD A,(BRLAB) CP 0 JP Z,BREND LD A,(5C3AH) CP 11 JR Z,BRNON CALL NOERR JP ENDEBRNON LD HL,(5C5DH) DEC HL LD A,(HL) CP "*" JP Z,BREND CALL NOERR JP ENDE RESET NOP  BUFF2 DEFS 50 USER1 DEFS 168 USER2 DEFS 168 USER3 DEFS 168 USER4 DEFS 168 TTTTT NOP  END  COPY 